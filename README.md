# Crowd Analyzer

![Project Logo](person_images/CA.png)

Crowd Analyzer is a final-year project by Othman Dahlan and Abdulrahman Jaber, supervised by Dr. Mohammed Abdullah at Al-Zaytoonah University of Jordan.

A FastAPI-based application for crowd analysis, image description, and face recognition. This project leverages YOLO, DeepFace, and GPT-4o to analyze video feeds, describe images, and recognize faces. The application also includes a frontend dashboard to visualize the data in real-time.


## How It Works

![How It Works](path/to/your/image.png)



## Table of Contents

- [Crowd Analyzer](#crowd-analyzer)
  - [Table of Contents](#table-of-contents)
  - [Features](#features)
  - [Getting Started](#getting-started)
    - [Prerequisites](#prerequisites)
    - [Installation](#installation)
    - [Running the Application](#running-the-application)
  - [API Endpoints](#api-endpoints)
  - [Frontend Dashboard](#frontend-dashboard)
  - [Examples](#examples)
  - [Contributing](#contributing)
  - [License](#license)

## Features

- **Crowd Analysis**: Analyze video feeds to detect and analyze people in crowds using YOLO and DeepFace. The application stores the data and provides analytics that can benefit businesses.
- **Image Description**: Describe images using the GPT-4o model.
- **Face Recognition**: Recognize faces from images and compare them against a stored database, enhancing the security aspect of any VMS system.
- **Database Integration**: Store and retrieve detected persons and their attributes in an SQLite database using SQLAlchemy as the ORM.
- **Analytics and Visualization**: Visualize data such as age, gender, race, emotion distribution, and more using a frontend dashboard built with HTML, CSS, and JavaScript.

## Getting Started

### Prerequisites

Make sure you have Python 3.8+ installed. You'll also need to install the following packages:

- FastAPI
- SQLAlchemy
- cv2 (OpenCV)
- requests
- YOLO
- DeepFace
- CORS middleware for FastAPI

All of the above packages are included in the `requirements.txt` file.

### Installation

1. **Clone the repository:**

   ```bash
   git clone https://github.com/crowdAnalyzer/your-repo-name.git
   cd crowdAnalyzer
   ```

2. **Create and activate a virtual environment:**

   ```bash
   python3 -m venv venv
   source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
   ```

3. **Install the required packages:**

   ```bash
   pip install -r requirements.txt
   ```

### Running the Application

1. **Start the FastAPI server:**

   ```bash
   uvicorn main:app --reload
   ```

   The server will start on `http://127.0.0.1:8000`.

2. **Access the API documentation:**

   Open a browser and navigate to `http://127.0.0.1:8000/docs` to view the interactive API documentation.

3. **Start the Frontend Dashboard:**

   Open the `index.html` file in your browser to launch the frontend dashboard. This dashboard provides real-time visualizations of the analyzed data.

## API Endpoints

The application includes several API endpoints that support key functionalities:

- **Crowd Analysis**: Upload and analyze video feeds to detect and analyze people in crowds.
- **Image Description**: Describe images using a base64-encoded input.
- **Face Recognition**: Insert individuals into the database and perform face recognition to find matches.
- **Analytics**: Generate statistical distributions for attributes like age, gender, race, emotion, and crowd density.
- **Data Export**: Export the collected data to a CSV file.
- **Visualization Support**: Provides data to the frontend for real-time visualization of various statistics.

## Frontend Dashboard

The frontend dashboard provides a user interface for visualizing the data generated by the Crowd Analyzer. It includes:

- **Live Video Feed Section**: Displays the live feed from a camera.
- **Input Forms**: Allows users to submit video paths, describe images, insert people into the database, and perform face recognition.
- **Matched People Statistics Section**: Displays various charts showing age, gender, race, and emotion distributions based on the data from the backend.

### Running the Dashboard

Simply open the `index.html` file in your browser after starting the FastAPI server.

## Examples

1. **Crowd Analysis**: Analyze a video and retrieve the details of detected persons.
2. **Describe Image**: Provide a base64-encoded image and get a description using the GPT-4o model.
3. **Face Recognition**: Upload an image, insert the person into the database, and perform face recognition.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
